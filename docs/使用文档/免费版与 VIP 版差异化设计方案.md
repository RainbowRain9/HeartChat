# HeartChat 小程序：免费版与 VIP 版差异化设计方案

## 1. 核心策略：基于 AI 模型分级

主要通过调用不同能力的智谱 AI (BigModel) 模型来实现免费版和 VIP 版的核心体验差异。

-   **免费版用户**: 调用 `GLM-4-Flash` 模型。
-   **VIP 版用户**: 调用更强大的 `GLM-4` 模型。

## 2. 模型分级方案分析

### 优点

*   **价值清晰**: `GLM-4` 相较于 `GLM-4-Flash` 通常在理解深度、生成质量、上下文处理能力等方面有明显提升，用户能直观感受到付费带来的对话体验升级。
*   **技术实现简单**: 后端逻辑主要是在调用智谱 AI API 时，根据用户身份动态切换 `model` 参数，改动相对较小。
*   **成本可控**: 利用 `GLM-4-Flash` 作为免费基础，有助于控制运营成本，尤其是项目初期。

### 需考虑的点

*   **体验差异验证**: 需要确保两个模型间的体验差异足够显著，能够有效驱动用户付费升级。
*   **成本与定价**: `GLM-4` 的调用成本高于 `GLM-4-Flash`，需要设计合理的 VIP 定价策略来覆盖成本并实现盈利。

## 3. 补充差异化维度 (可与模型分级结合)

为了进一步提升 VIP 价值和吸引力，可以结合以下维度进行差异化设计：

### 3.1 功能限制

*   **对话历史长度**:
    *   免费版：限制记忆轮数（如最近 5-10 轮）。
    *   VIP 版：支持更长的对话历史（如最近 20-30 轮或更多），提供更连贯的对话体验。
*   **角色定制**:
    *   免费版：仅能使用预设的系统角色。
    *   VIP 版：允许用户创建、编辑、保存和使用自定义 AI 角色。
*   **高级分析与报告**:
    *   免费版：仅显示基础情绪标签（如开心、悲伤）。
    *   VIP 版：提供详细情绪分析（如强度、关键词）、情绪历史趋势图、深入的每日/每周/每月心情报告、初步的用户画像分析等。
*   **使用频率/次数**:
    *   免费版：每日对话次数、分析次数、报告生成次数等可能受限。
    *   VIP 版：无限制或享有更高的使用额度。

### 3.2 性能与体验

*   **响应优先级 (理论)**: (实现较复杂，初期可不考虑) VIP 用户请求理论上可获得更高处理优先级。
*   **无广告**:
    *   免费版：可能包含少量广告以维持运营。
    *   VIP 版：提供纯净、无广告的使用体验。

### 3.3 增值服务

*   **专属 VIP 角色**: 提供设计更精良、能力更独特的 AI 角色，仅供 VIP 用户使用。
*   **数据导出**: (可选) VIP 用户可以导出自己的聊天记录或情绪分析数据。

## 4. 建议的组合方案

| 功能/特性        | 免费版                                    | VIP 版                                                                  |
| :--------------- | :---------------------------------------- | :---------------------------------------------------------------------- |
| **核心 AI 模型** | **GLM-4-Flash**                           | **GLM-4**                                                               |
| 对话历史长度     | 有限 (如 5-10 轮)                         | 更长 (如 20-30 轮+)                                                     |
| 角色使用         | 仅限预设系统角色                          | 可使用系统角色 + 创建/使用自定义角色                                        |
| 情绪分析         | 基础情绪标签                              | 详细分析 (强度、关键词)                                                 |
| 历史与报告       | 不可用 或 仅基础功能                      | 情绪历史趋势图、详细每日/每周/每月报告                                    |
| 使用限制         | 可能有每日次数/频率限制                   | 无限制或更高额度                                                        |
| 广告             | 可能有                                    | 无广告                                                                  |
| (可选) 专属内容 | 无                                        | 专属 VIP 角色                                                           |
| (可选) 数据导出 | 不支持                                    | 支持                                                                    |

## 5. 技术实现要点

1.  **数据库 (`users` 集合)**:
    *   添加字段用于标识用户身份，例如 `is_vip` (Boolean) 和 `vip_expires_at` (Timestamp)。
2.  **云函数 (如 `chat`, `analysis`)**:
    *   在函数入口处，根据 `userId` 查询用户的 VIP 状态。
    *   根据 VIP 状态：
        *   选择调用智谱 AI 的 `model` 参数 (`glm-4.5-flash` 或 `glm-4`)。
        *   决定传递给 AI 的历史消息数量。
        *   决定是否执行高级分析或生成报告的逻辑。
        *   (如果有限制) 检查并更新用户的使用次数。
3.  **前端页面**:
    *   根据用户的 VIP 状态，显示或隐藏特定功能入口（如自定义角色、高级报告、去广告标识）。
    *   在触发受限功能时，提示用户升级 VIP。

## 6. 关于引入其他 AI 模型的建议

*   **初期聚焦**: 建议项目初期优先在智谱 AI 平台内部进行模型分级 (GLM-4-Flash vs GLM-4)，这样可以简化 API 对接、密钥管理和计费逻辑。
*   **谨慎引入**: 暂时不建议引入 DeepSeek 或其他平台的模型，除非经过充分评估，确认其能在特定方面提供智谱平台无法替代的关键价值，且愿意承担额外的开发和维护成本。

---

这份文档总结了差异化设计的核心思路和具体方案，可以在后续开发和迭代中作为参考。