# HeartChat AIæµç¨‹é‡æ„Difyé›†æˆæ–¹æ¡ˆ

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜äº†å¦‚ä½•å°†HeartChatç°æœ‰çš„AIæµç¨‹é‡æ„å¹¶é›†æˆåˆ°Difyå·¥ä½œæµå¹³å°ä¸­ã€‚é€šè¿‡æ­¤é‡æ„ï¼Œæˆ‘ä»¬å°†ä¼˜åŒ–ç³»ç»Ÿæ¶æ„ï¼Œæå‡æ€§èƒ½ï¼Œæ”¹å–„ç»´æŠ¤æ€§ï¼Œå¹¶ä¸ºæœªæ¥åŠŸèƒ½æ‰©å±•æä¾›æ›´å¥½çš„åŸºç¡€ã€‚

## ğŸ¯ é‡æ„ç›®æ ‡

### æ ¸å¿ƒç›®æ ‡
1. **æ¶æ„ä¼˜åŒ–**ï¼šå°†ç°æœ‰çš„3ä¸ªäº‘å‡½æ•°(chatã€analysisã€roles)æ•´åˆä¸ºDifyå·¥ä½œæµ
2. **æ€§èƒ½æå‡**ï¼šå‡å°‘äº‘å‡½æ•°é—´è°ƒç”¨ï¼Œæé«˜å“åº”é€Ÿåº¦
3. **ç»´æŠ¤æ€§æ”¹å–„**ï¼šå¯è§†åŒ–å·¥ä½œæµç¼–è¾‘ï¼Œç»Ÿä¸€ç®¡ç†
4. **æ‰©å±•æ€§å¢å¼º**ï¼šæ›´å®¹æ˜“æ·»åŠ æ–°çš„AIåŠŸèƒ½å’Œç‰¹æ€§

### é¢„æœŸæ”¶ç›Š
- å¼€å‘æ•ˆç‡æå‡ï¼šå·¥ä½œæµå¯è§†åŒ–å¼€å‘ï¼Œå‡å°‘ç¼–ç å·¥ä½œé‡
- ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–ï¼šå‡å°‘äº‘å‡½æ•°è°ƒç”¨ï¼Œæé«˜å“åº”é€Ÿåº¦
- ç»´æŠ¤æˆæœ¬é™ä½ï¼šç»Ÿä¸€çš„å·¥ä½œæµç®¡ç†ï¼Œå‡å°‘ç»´æŠ¤å¤æ‚åº¦
- åŠŸèƒ½æ‰©å±•æ€§ï¼šæ›´å®¹æ˜“æ·»åŠ æ–°çš„AIåŠŸèƒ½å’Œç‰¹æ€§
- ç”¨æˆ·ä½“éªŒæ”¹å–„ï¼šæ›´å¿«çš„å“åº”é€Ÿåº¦ï¼Œæ›´å¥½çš„æƒ…æ„Ÿåˆ†ææ•ˆæœ

## ğŸ“Š ç°æœ‰ç³»ç»Ÿåˆ†æ

### å½“å‰AIæµç¨‹æ¶æ„

#### 1. Chatäº‘å‡½æ•°æµç¨‹
- **åŠŸèƒ½**ï¼šå¤„ç†èŠå¤©æ¶ˆæ¯ã€AIå›å¤ç”Ÿæˆã€æ¶ˆæ¯åˆ†æ®µ
- **ä¸»è¦æ¥å£**ï¼šsendMessage, getChatHistory, saveChatHistory
- **æ€§èƒ½æŒ‡æ ‡**ï¼šå¹³å‡å“åº”æ—¶é—´1200msï¼Œæœ€å¤§å¹¶å‘æ•°50

#### 2. Analysisäº‘å‡½æ•°æµç¨‹
- **åŠŸèƒ½**ï¼šæƒ…æ„Ÿåˆ†æã€å…³é”®è¯æå–ã€ç”¨æˆ·å…´è¶£åˆ†æã€æ¯æ—¥æŠ¥å‘Šç”Ÿæˆ
- **ä¸»è¦æ¥å£**ï¼šemotion, keywords, user_interests, daily_report
- **å¤„ç†ç‰¹ç‚¹**ï¼šå¹¶è¡Œå¤„ç†æƒ…æ„Ÿå’Œå…³é”®è¯åˆ†æ

#### 3. Rolesäº‘å‡½æ•°æµç¨‹
- **åŠŸèƒ½**ï¼šè§’è‰²ç®¡ç†ã€æç¤ºè¯ç”Ÿæˆã€ç”¨æˆ·ç”»åƒç»´æŠ¤
- **ä¸»è¦æ¥å£**ï¼šgetRoles, createRole, updateRole, generatePrompt

#### 4. æ•°æ®åº“ç»“æ„
- **users**ï¼šç»Ÿä¸€ç”¨æˆ·ä¿¡æ¯é›†åˆï¼ˆåŸºç¡€ä¿¡æ¯ã€profileã€configã€statsï¼‰
- **roles**ï¼šè§’è‰²ä¿¡æ¯é›†åˆï¼ŒåŒ…å«user_perceptionå’Œmemories
- **chats**ï¼šèŠå¤©ä¼šè¯é›†åˆ
- **messages**ï¼šæ¶ˆæ¯è¯¦æƒ…é›†åˆï¼Œæ”¯æŒåˆ†æ®µæ¶ˆæ¯
- **emotionRecords**ï¼šæƒ…æ„Ÿåˆ†æè®°å½•é›†åˆ
- **userReports**ï¼šç”¨æˆ·æ¯æ—¥æŠ¥å‘Šé›†åˆ
- **userInterests**ï¼šç”¨æˆ·å…´è¶£æ•°æ®é›†åˆ

### ç°æœ‰æ¶æ„é—®é¢˜
1. **äº‘å‡½æ•°é—´è°ƒç”¨é¢‘ç¹**ï¼šchatã€analysisã€rolesä¹‹é—´ç›¸äº’è°ƒç”¨ï¼Œå¢åŠ å»¶è¿Ÿ
2. **ä»£ç é‡å¤**ï¼šå¤šä¸ªäº‘å‡½æ•°ä¸­æœ‰ç›¸ä¼¼çš„æ•°æ®å¤„ç†é€»è¾‘
3. **ç»´æŠ¤å¤æ‚**ï¼šéœ€è¦åŒæ—¶ç»´æŠ¤3ä¸ªäº‘å‡½æ•°çš„ä»£ç 
4. **æ‰©å±•å›°éš¾**ï¼šæ·»åŠ æ–°åŠŸèƒ½éœ€è¦ä¿®æ”¹å¤šä¸ªäº‘å‡½æ•°
5. **ç›‘æ§åˆ†æ•£**ï¼šéœ€è¦åˆ†åˆ«ç›‘æ§å¤šä¸ªäº‘å‡½æ•°çš„è¿è¡ŒçŠ¶æ€

## ğŸ› ï¸ Difyå·¥ä½œæµè®¾è®¡æ–¹æ¡ˆ

### æ ¸å¿ƒå·¥ä½œæµæ¶æ„

#### 1. æ™ºèƒ½èŠå¤©å¯¹è¯å¤„ç†æµç¨‹

**æµç¨‹å›¾**ï¼š
```mermaid
graph TD
    A[è¾“å…¥ç”¨æˆ·æ¶ˆæ¯] --> B[æ•°æ®è·å–èŠ‚ç‚¹]
    B --> C[è§’è‰²ä¿¡æ¯æŸ¥è¯¢]
    B --> D[å†å²æ¶ˆæ¯è·å–]
    B --> E[ç”¨æˆ·ç”»åƒè·å–]
    
    C --> F[æç¤ºè¯æ„å»ºèŠ‚ç‚¹]
    D --> F
    E --> F
    
    F --> G[AIå›å¤ç”ŸæˆèŠ‚ç‚¹]
    G --> H[æ¶ˆæ¯åˆ†æ®µå¤„ç†èŠ‚ç‚¹]
    H --> I[æƒ…æ„Ÿåˆ†æèŠ‚ç‚¹]
    
    I --> J[æ•°æ®å­˜å‚¨èŠ‚ç‚¹]
    J --> K[ä¿å­˜æ¶ˆæ¯]
    J --> L[æ›´æ–°ä¼šè¯]
    J --> M[å­˜å‚¨æƒ…æ„Ÿè®°å½•]
    
    K --> N[è¾“å‡ºèŠ‚ç‚¹]
    L --> N
    M --> N
    
    N --> O[è¿”å›åˆ†æ®µæ¶ˆæ¯å’Œåˆ†æç»“æœ]
```

**è¾“å…¥å‚æ•°**ï¼š
```json
{
  "user_id": "ç”¨æˆ·ID",
  "role_id": "è§’è‰²ID", 
  "chat_id": "ä¼šè¯ID",
  "message_content": "æ¶ˆæ¯å†…å®¹",
  "session_id": "ä¼šè¯æ ‡è¯†"
}
```

**è¾“å‡ºç»“æœ**ï¼š
```json
{
  "message_segments": [
    {
      "content": "åˆ†æ®µå†…å®¹",
      "segment_index": 0,
      "total_segments": 3
    }
  ],
  "emotion_analysis": {
    "primary_emotion": "ä¸»è¦æƒ…æ„Ÿ",
    "intensity": 0.8,
    "suggestions": ["å»ºè®®1", "å»ºè®®2"]
  },
  "updated_stats": {
    "chat_count": 15,
    "active_days": 7
  }
}
```

**å¤„ç†æ­¥éª¤**ï¼š
1. **æ•°æ®è·å–**ï¼šå¹¶è¡ŒæŸ¥è¯¢è§’è‰²ä¿¡æ¯ã€å†å²æ¶ˆæ¯ã€ç”¨æˆ·ç”»åƒ
2. **æç¤ºè¯æ„å»º**ï¼šåŸºäºä¼˜å…ˆçº§æ„å»ºç³»ç»Ÿæç¤ºè¯
3. **AIå›å¤ç”Ÿæˆ**ï¼šè°ƒç”¨å¤§è¯­è¨€æ¨¡å‹ç”Ÿæˆå›å¤
4. **æ¶ˆæ¯åˆ†æ®µ**ï¼šæ™ºèƒ½åˆ†æ®µç®—æ³•å¤„ç†é•¿å›å¤
5. **æƒ…æ„Ÿåˆ†æ**ï¼šå®æ—¶æƒ…æ„Ÿåˆ†æ
6. **æ•°æ®å­˜å‚¨**ï¼šæ‰¹é‡ä¿å­˜æ‰€æœ‰ç›¸å…³æ•°æ®
7. **ç»“æœè¿”å›**ï¼šè¿”å›å¤„ç†ç»“æœ

#### 2. æ·±åº¦æƒ…æ„Ÿåˆ†ææµç¨‹

**æµç¨‹å›¾**ï¼š
```mermaid
graph TD
    A[è¾“å…¥åˆ†ææ–‡æœ¬] --> B[é¢„å¤„ç†èŠ‚ç‚¹]
    B --> C[å¹¶è¡Œå¤„ç†èŠ‚ç‚¹]
    
    C --> D[æƒ…æ„Ÿåˆ†æå­èŠ‚ç‚¹]
    C --> E[å…³é”®è¯æå–å­èŠ‚ç‚¹]
    C --> F[ä¸Šä¸‹æ–‡åˆ†æå­èŠ‚ç‚¹]
    
    D --> G[æ•°æ®æ•´åˆèŠ‚ç‚¹]
    E --> G
    F --> G
    
    G --> H[æƒé‡è®¡ç®—èŠ‚ç‚¹]
    H --> I[ç”¨æˆ·å…´è¶£æ›´æ–°èŠ‚ç‚¹]
    I --> J[æ•°æ®å­˜å‚¨èŠ‚ç‚¹]
    J --> K[è¾“å‡ºåˆ†æç»“æœ]
```

**è¾“å…¥å‚æ•°**ï¼š
```json
{
  "text": "å¾…åˆ†ææ–‡æœ¬",
  "user_id": "ç”¨æˆ·ID",
  "role_id": "è§’è‰²ID",
  "chat_id": "ä¼šè¯ID",
  "context": "ä¸Šä¸‹æ–‡ä¿¡æ¯"
}
```

**è¾“å‡ºç»“æœ**ï¼š
```json
{
  "emotion_analysis": {
    "primary_emotion": "å¹³é™",
    "secondary_emotions": ["å®‰å¿ƒ", "æ”¾æ¾"],
    "intensity": 0.7,
    "valence": 0.6,
    "arousal": 0.4,
    "radar_dimensions": {
      "trust": 0.8,
      "openness": 0.7,
      "resistance": 0.3,
      "stress": 0.4,
      "control": 0.6
    }
  },
  "keywords": [
    {
      "word": "å·¥ä½œ",
      "weight": 0.8,
      "category": "èŒåœº",
      "emotion_score": 0.6
    }
  ],
  "suggestions": ["å»ºè®®1", "å»ºè®®2"]
}
```

#### 3. ä¸ªæ€§åŒ–ç”¨æˆ·æŠ¥å‘Šç”Ÿæˆæµç¨‹

**æµç¨‹å›¾**ï¼š
```mermaid
graph TD
    A[è¾“å…¥ç”¨æˆ·IDå’Œæ—¥æœŸ] --> B[æ•°æ®æ”¶é›†èŠ‚ç‚¹]
    B --> C[æƒ…æ„Ÿè®°å½•æ”¶é›†]
    B --> D[ç”¨æˆ·å…´è¶£æ”¶é›†]
    
    C --> E[æ•°æ®åˆ†æèŠ‚ç‚¹]
    D --> E
    
    E --> F[æƒ…æ„Ÿåˆ†å¸ƒç»Ÿè®¡]
    E --> G[å…³é”®è¯åˆ†æ]
    E --> H[å…³æ³¨ç‚¹åˆ†æ]
    
    F --> I[AIå†…å®¹ç”ŸæˆèŠ‚ç‚¹]
    G --> I
    H --> I
    
    I --> J[å›¾è¡¨æ•°æ®ç”ŸæˆèŠ‚ç‚¹]
    J --> K[æŠ¥å‘Šç»„è£…èŠ‚ç‚¹]
    K --> L[æ•°æ®å­˜å‚¨èŠ‚ç‚¹]
    L --> M[é€šçŸ¥è§¦å‘èŠ‚ç‚¹]
    M --> N[è¾“å‡ºå®Œæ•´æŠ¥å‘Š]
```

**è¾“å…¥å‚æ•°**ï¼š
```json
{
  "user_id": "ç”¨æˆ·ID",
  "report_date": "æŠ¥å‘Šæ—¥æœŸ",
  "force_regenerate": false
}
```

**è¾“å‡ºç»“æœ**ï¼š
```json
{
  "emotionSummary": "æƒ…æ„Ÿæ€»ç»“æ–‡æœ¬",
  "insights": ["æ´å¯Ÿ1", "æ´å¯Ÿ2"],
  "suggestions": ["å»ºè®®1", "å»ºè®®2"],
  "fortune": {
    "good": ["å®œåšäº‹é¡¹"],
    "bad": ["å¿Œåšäº‹é¡¹"]
  },
  "chartData": {
    "emotionDistribution": [
      {"type": "å¹³é™", "count": 5, "percentage": "50%"}
    ],
    "intensityTrend": [
      {"timestamp": "æ—¶é—´", "intensity": 0.7, "type": "å¹³é™"}
    ],
    "focusDistribution": [
      {"category": "èŒåœº", "weight": 0.8, "percentage": "40%"}
    ]
  }
}
```

#### 4. æ™ºèƒ½ç”¨æˆ·ç”»åƒæ›´æ–°æµç¨‹

**æµç¨‹å›¾**ï¼š
```mermaid
graph TD
    A[è¾“å…¥ç”¨æˆ·IDå’Œå¯¹è¯å†å²] --> B[è¡Œä¸ºåˆ†æèŠ‚ç‚¹]
    B --> C[å…´è¶£è¯†åˆ«èŠ‚ç‚¹]
    C --> D[æ€§æ ¼åˆ†æèŠ‚ç‚¹]
    D --> E[æƒ…æ„Ÿæ¨¡å¼è¯†åˆ«èŠ‚ç‚¹]
    
    E --> F[ç”»åƒæ›´æ–°èŠ‚ç‚¹]
    F --> G[æ•°æ®å­˜å‚¨èŠ‚ç‚¹]
    G --> H[è¾“å‡ºæ›´æ–°ç»“æœ]
```

**è¾“å…¥å‚æ•°**ï¼š
```json
{
  "user_id": "ç”¨æˆ·ID",
  "conversation_history": [
    {
      "role": "user",
      "content": "ç”¨æˆ·æ¶ˆæ¯",
      "timestamp": "æ—¶é—´æˆ³"
    }
  ],
  "update_type": "partial"
}
```

**è¾“å‡ºç»“æœ**ï¼š
```json
{
  "user_perception": {
    "interests": ["å…´è¶£1", "å…´è¶£2"],
    "preferences": ["åå¥½1", "åå¥½2"],
    "communication_style": "æ²Ÿé€šé£æ ¼",
    "emotional_patterns": ["æƒ…æ„Ÿæ¨¡å¼1", "æƒ…æ„Ÿæ¨¡å¼2"]
  },
  "updated_fields": ["interests", "communication_style"],
  "confidence_score": 0.85
}
```

## ğŸ”§ æŠ€æœ¯å®ç°æ–¹æ¡ˆ

### Difyé›†æˆæ¶æ„

#### 1. æ•´ä½“æ¶æ„å›¾
```mermaid
graph TB
    subgraph "å‰ç«¯å±‚"
        A[å¾®ä¿¡å°ç¨‹åº] --> B[APIç½‘å…³]
    end
    
    subgraph "ä¸šåŠ¡å±‚"
        B --> C[ç°æœ‰APIé€‚é…å±‚]
        C --> D[Difyå·¥ä½œæµå¼•æ“]
    end
    
    subgraph "Difyå·¥ä½œæµ"
        D --> E[èŠå¤©å¯¹è¯å¤„ç†æµç¨‹]
        D --> F[æƒ…æ„Ÿåˆ†ææµç¨‹]
        D --> G[æŠ¥å‘Šç”Ÿæˆæµç¨‹]
        D --> H[ç”¨æˆ·ç”»åƒæ›´æ–°æµç¨‹]
    end
    
    subgraph "æ•°æ®å±‚"
        E --> I[æ•°æ®åº“]
        F --> I
        G --> I
        H --> I
    end
    
    subgraph "å¤–éƒ¨æœåŠ¡"
        D --> J[æ™ºè°±AI]
        D --> K[å…¶ä»–AIæœåŠ¡]
    end
```

#### 2. APIé€‚é…å±‚è®¾è®¡

**ç°æœ‰APIå…¼å®¹**ï¼š
- ä¿æŒç°æœ‰çš„å¾®ä¿¡å°ç¨‹åºAPIæ¥å£ä¸å˜
- å†…éƒ¨è°ƒç”¨Difyå·¥ä½œæµAPI
- ç»´æŒæ•°æ®æ ¼å¼å…¼å®¹æ€§

**æ–°å¢APIæ¥å£**ï¼š
```javascript
// å·¥ä½œæµæ‰§è¡Œæ¥å£
POST /api/workflow/execute
{
  "workflow_id": "workflow_id",
  "inputs": {
    "user_id": "user123",
    "message_content": "æ¶ˆæ¯å†…å®¹"
  },
  "response_mode": "streaming",
  "user": "user123"
}

// å·¥ä½œæµçŠ¶æ€æŸ¥è¯¢æ¥å£
GET /api/workflow/status/:workflow_run_id
```

### æ•°æ®æ ¼å¼è½¬æ¢ç­–ç•¥

#### 1. æ¶ˆæ¯æ•°æ®è½¬æ¢
```javascript
// Difyè¾“å‡ºè½¬æ¢ä¸ºmessagesé›†åˆæ ¼å¼
function convertToMessageFormat(difyOutput, chatId, userId) {
  return {
    _id: new ObjectId(),
    chatId: chatId,
    openId: userId,
    roleId: difyOutput.role_id,
    sender_type: 'ai',
    content: difyOutput.content,
    status: 'delivered',
    createTime: new Date(),
    isSegment: difyOutput.is_segment,
    segmentIndex: difyOutput.segment_index,
    totalSegments: difyOutput.total_segments,
    originalMessageId: difyOutput.original_message_id
  };
}
```

#### 2. æƒ…æ„Ÿåˆ†ææ•°æ®è½¬æ¢
```javascript
// Difyè¾“å‡ºè½¬æ¢ä¸ºemotionRecordsé›†åˆæ ¼å¼
function convertToEmotionRecordFormat(difyOutput, userId, chatId) {
  return {
    _id: new ObjectId(),
    userId: userId,
    roleId: difyOutput.role_id,
    chatId: chatId,
    originalText: difyOutput.original_text,
    analysis: {
      primary_emotion: difyOutput.primary_emotion,
      secondary_emotions: difyOutput.secondary_emotions,
      intensity: difyOutput.intensity,
      valence: difyOutput.valence,
      arousal: difyOutput.arousal,
      trend: difyOutput.trend,
      trend_en: difyOutput.trend_en,
      radar_dimensions: difyOutput.radar_dimensions,
      suggestions: difyOutput.suggestions,
      summary: difyOutput.summary
    },
    createTime: new Date()
  };
}
```

#### 3. ç”¨æˆ·æŠ¥å‘Šæ•°æ®è½¬æ¢
```javascript
// Difyè¾“å‡ºè½¬æ¢ä¸ºuserReportsé›†åˆæ ¼å¼
function convertToUserReportFormat(difyOutput, userId, reportDate) {
  return {
    _id: new ObjectId(),
    userId: userId,
    date: reportDate,
    emotionSummary: difyOutput.emotion_summary,
    insights: difyOutput.insights,
    suggestions: difyOutput.suggestions,
    fortune: difyOutput.fortune,
    encouragement: difyOutput.encouragement,
    keywords: difyOutput.keywords,
    emotionalVolatility: difyOutput.emotional_volatility,
    primaryEmotion: difyOutput.primary_emotion,
    emotionCount: difyOutput.emotion_count,
    focusPoints: difyOutput.focus_points,
    categoryWeights: difyOutput.category_weights,
    chartData: difyOutput.chart_data,
    isRead: false,
    generatedAt: new Date()
  };
}
```

### æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

#### 1. å¹¶è¡Œå¤„ç†ä¼˜åŒ–
```javascript
// åˆ©ç”¨Difyçš„å¹¶è¡Œå¤„ç†èƒ½åŠ›
const parallelProcessing = {
  emotion_analysis: {
    type: "parallel",
    tasks: [
      {
        name: "æƒ…æ„Ÿåˆ†æ",
        model: "glm-4-flash",
        prompt: "æƒ…æ„Ÿåˆ†ææç¤ºè¯"
      },
      {
        name: "å…³é”®è¯æå–", 
        model: "glm-4-flash",
        prompt: "å…³é”®è¯æå–æç¤ºè¯"
      },
      {
        name: "ä¸Šä¸‹æ–‡åˆ†æ",
        model: "glm-4-flash", 
        prompt: "ä¸Šä¸‹æ–‡åˆ†ææç¤ºè¯"
      }
    ]
  }
};
```

#### 2. ç¼“å­˜ç­–ç•¥
```javascript
// è§’è‰²ä¿¡æ¯å’Œç”¨æˆ·ç”»åƒç¼“å­˜
const cacheStrategy = {
  role_cache: {
    ttl: 3600, // 1å°æ—¶
    key_pattern: "role_{role_id}"
  },
  user_profile_cache: {
    ttl: 1800, // 30åˆ†é’Ÿ
    key_pattern: "user_profile_{user_id}"
  },
  prompt_template_cache: {
    ttl: 7200, // 2å°æ—¶
    key_pattern: "prompt_{template_type}_{role_id}"
  }
};
```

#### 3. æ•°æ®åº“ä¼˜åŒ–
```javascript
// æ‰¹é‡æ•°æ®æ›´æ–°
const batchUpdate = {
  messages: {
    operation: "bulk_write",
    batch_size: 100,
    write_concern: { w: "majority" }
  },
  emotion_records: {
    operation: "bulk_write", 
    batch_size: 50,
    write_concern: { w: "majority" }
  }
};
```

## ğŸ“‹ å®æ–½è®¡åˆ’

### ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€æ¶æ„æ­å»ºï¼ˆ2-3å‘¨ï¼‰

#### 1. Difyç¯å¢ƒå‡†å¤‡
- [ ] éƒ¨ç½²DifyæœåŠ¡
- [ ] é…ç½®AIæ¨¡å‹ï¼ˆæ™ºè°±AIï¼‰
- [ ] è®¾ç½®æ•°æ®åº“è¿æ¥
- [ ] é…ç½®APIå¯†é’¥å’Œæƒé™

#### 2. æ•°æ®è½¬æ¢å±‚å¼€å‘
- [ ] å®ç°æ¶ˆæ¯æ•°æ®è½¬æ¢å‡½æ•°
- [ ] å®ç°æƒ…æ„Ÿåˆ†ææ•°æ®è½¬æ¢å‡½æ•°
- [ ] å®ç°ç”¨æˆ·æŠ¥å‘Šæ•°æ®è½¬æ¢å‡½æ•°
- [ ] å®ç°ç”¨æˆ·ç”»åƒæ•°æ®è½¬æ¢å‡½æ•°

#### 3. APIé€‚é…å±‚å¼€å‘
- [ ] å®ç°ç°æœ‰APIå…¼å®¹å±‚
- [ ] å¼€å‘å·¥ä½œæµæ‰§è¡Œæ¥å£
- [ ] å¼€å‘å·¥ä½œæµçŠ¶æ€æŸ¥è¯¢æ¥å£
- [ ] å®ç°é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶

### ç¬¬äºŒé˜¶æ®µï¼šèŠå¤©å¯¹è¯å¤„ç†æµç¨‹ï¼ˆ3-4å‘¨ï¼‰

#### 1. å·¥ä½œæµè®¾è®¡
- [ ] è®¾è®¡èŠå¤©å¯¹è¯å¤„ç†å·¥ä½œæµ
- [ ] é…ç½®æç¤ºè¯æ¨¡æ¿
- [ ] è®¾ç½®æ¶ˆæ¯åˆ†æ®µç®—æ³•
- [ ] é…ç½®æƒ…æ„Ÿåˆ†æèŠ‚ç‚¹

#### 2. æµ‹è¯•å’ŒéªŒè¯
- [ ] å•å…ƒæµ‹è¯•å„ä¸ªèŠ‚ç‚¹
- [ ] é›†æˆæµ‹è¯•æ•´ä¸ªæµç¨‹
- [ ] æ€§èƒ½æµ‹è¯•å’Œä¼˜åŒ–
- [ ] æ•°æ®æ ¼å¼éªŒè¯

#### 3. ç°åº¦å‘å¸ƒ
- [ ] é€‰æ‹©æµ‹è¯•ç”¨æˆ·
- [ ] æ”¶é›†ç”¨æˆ·åé¦ˆ
- [ ] ç›‘æ§ç³»ç»Ÿæ€§èƒ½
- [ ] ä¿®å¤å‘ç°çš„é—®é¢˜

### ç¬¬ä¸‰é˜¶æ®µï¼šæƒ…æ„Ÿåˆ†ææµç¨‹ï¼ˆ2-3å‘¨ï¼‰

#### 1. å·¥ä½œæµè¿ç§»
- [ ] è®¾è®¡æƒ…æ„Ÿåˆ†æå·¥ä½œæµ
- [ ] è¿ç§»ç°æœ‰åˆ†æé€»è¾‘
- [ ] ä¼˜åŒ–å¹¶è¡Œå¤„ç†èƒ½åŠ›
- [ ] å®ç°é«˜çº§åˆ†æåŠŸèƒ½

#### 2. æ•°æ®åŒæ­¥
- [ ] ç¡®ä¿æ•°æ®ä¸€è‡´æ€§
- [ ] å®ç°æ•°æ®è¿ç§»è„šæœ¬
- [ ] éªŒè¯æ•°æ®å®Œæ•´æ€§
- [ ] å»ºç«‹æ•°æ®å¤‡ä»½æœºåˆ¶

### ç¬¬å››é˜¶æ®µï¼šç”¨æˆ·æŠ¥å‘Šç”Ÿæˆæµç¨‹ï¼ˆ2-3å‘¨ï¼‰

#### 1. å·¥ä½œæµå®ç°
- [ ] è®¾è®¡æŠ¥å‘Šç”Ÿæˆå·¥ä½œæµ
- [ ] å®ç°AIå†…å®¹ç”Ÿæˆ
- [ ] ç”Ÿæˆå›¾è¡¨æ•°æ®
- [ ] ä¼˜åŒ–æŠ¥å‘Šæ¨¡æ¿

#### 2. åŠŸèƒ½å¢å¼º
- [ ] æ·»åŠ æ›´å¤šæŠ¥å‘Šç±»å‹
- [ ] å®ç°ä¸ªæ€§åŒ–å®šåˆ¶
- [ ] ä¼˜åŒ–æŠ¥å‘Šè´¨é‡
- [ ] å¢åŠ äº¤äº’åŠŸèƒ½

### ç¬¬äº”é˜¶æ®µï¼šç”¨æˆ·ç”»åƒæ›´æ–°æµç¨‹ï¼ˆ1-2å‘¨ï¼‰

#### 1. æ™ºèƒ½ç”»åƒç³»ç»Ÿ
- [ ] è®¾è®¡ç”¨æˆ·ç”»åƒå·¥ä½œæµ
- [ ] å®ç°æ™ºèƒ½åˆ†æç®—æ³•
- [ ] ä¼˜åŒ–ç”»åƒæ›´æ–°ç­–ç•¥
- [ ] å»ºç«‹ç”»åƒè¯„ä¼°æœºåˆ¶

#### 2. ç³»ç»Ÿé›†æˆ
- [ ] å®Œæˆæ‰€æœ‰å·¥ä½œæµé›†æˆ
- [ ] å®ç°ç³»ç»Ÿç›‘æ§
- [ ] å»ºç«‹æ—¥å¿—ç³»ç»Ÿ
- [ ] å®Œå–„æ–‡æ¡£

## ğŸ”’ é£é™©æ§åˆ¶ç­–ç•¥

### æ•°æ®å®‰å…¨é£é™©
1. **æ•°æ®åŠ å¯†**
   - ä¼ è¾“æ•°æ®ä½¿ç”¨HTTPSåŠ å¯†
   - æ•æ„Ÿæ•°æ®å­˜å‚¨åŠ å¯†
   - APIå¯†é’¥å®‰å…¨ç®¡ç†

2. **è®¿é—®æ§åˆ¶**
   - å®æ–½ç»†ç²’åº¦æƒé™æ§åˆ¶
   - APIè®¿é—®é¢‘ç‡é™åˆ¶
   - ç”¨æˆ·æ•°æ®éš”ç¦»

3. **æ•°æ®å¤‡ä»½**
   - å®šæœŸæ•°æ®å¤‡ä»½
   - ç¾éš¾æ¢å¤è®¡åˆ’
   - æ•°æ®ç‰ˆæœ¬æ§åˆ¶

### ç³»ç»Ÿç¨³å®šæ€§é£é™©
1. **å®¹é”™æœºåˆ¶**
   - å·¥ä½œæµå¤±è´¥é‡è¯•
   - é™çº§å¤„ç†ç­–ç•¥
   - ç³»ç»Ÿå¥åº·æ£€æŸ¥

2. **ç›‘æ§å‘Šè­¦**
   - å®æ—¶æ€§èƒ½ç›‘æ§
   - é”™è¯¯æ—¥å¿—æ”¶é›†
   - è‡ªåŠ¨å‘Šè­¦æœºåˆ¶

3. **è´Ÿè½½å‡è¡¡**
   - å·¥ä½œæµè´Ÿè½½åˆ†é…
   - èµ„æºä½¿ç”¨ä¼˜åŒ–
   - è‡ªåŠ¨æ‰©ç¼©å®¹

### ä¸šåŠ¡è¿ç»­æ€§é£é™©
1. **æ¸è¿›å¼è¿ç§»**
   - ä¿æŒç°æœ‰ç³»ç»Ÿè¿è¡Œ
   - é€æ­¥åˆ‡æ¢åˆ°æ–°ç³»ç»Ÿ
   - å¿«é€Ÿå›æ»šæœºåˆ¶

2. **å…¼å®¹æ€§ä¿è¯**
   - APIå…¼å®¹æ€§æµ‹è¯•
   - æ•°æ®æ ¼å¼éªŒè¯
   - ç”¨æˆ·ä½“éªŒä¸€è‡´æ€§

## ğŸ“ˆ ç›‘æ§å’Œè¯„ä¼°

### æ€§èƒ½æŒ‡æ ‡
1. **å“åº”æ—¶é—´**
   - èŠå¤©å“åº”æ—¶é—´ï¼šç›®æ ‡<1000ms
   - æƒ…æ„Ÿåˆ†ææ—¶é—´ï¼šç›®æ ‡<800ms
   - æŠ¥å‘Šç”Ÿæˆæ—¶é—´ï¼šç›®æ ‡<3000ms

2. **å¹¶å‘èƒ½åŠ›**
   - æœ€å¤§å¹¶å‘ç”¨æˆ·æ•°ï¼šç›®æ ‡100
   - å·¥ä½œæµæ‰§è¡ŒQPSï¼šç›®æ ‡50
   - æ•°æ®åº“è¿æ¥æ± ï¼šç›®æ ‡20

3. **å¯ç”¨æ€§**
   - ç³»ç»Ÿå¯ç”¨æ€§ï¼šç›®æ ‡99.9%
   - å·¥ä½œæµæˆåŠŸç‡ï¼šç›®æ ‡99.5%
   - APIå“åº”æˆåŠŸç‡ï¼šç›®æ ‡99.8%

### ä¸šåŠ¡æŒ‡æ ‡
1. **ç”¨æˆ·æ´»è·ƒåº¦**
   - æ—¥æ´»è·ƒç”¨æˆ·æ•°
   - ç”¨æˆ·ç•™å­˜ç‡
   - ä¼šè¯æ—¶é•¿

2. **åŠŸèƒ½ä½¿ç”¨æƒ…å†µ**
   - èŠå¤©åŠŸèƒ½ä½¿ç”¨ç‡
   - æƒ…æ„Ÿåˆ†æä½¿ç”¨ç‡
   - æŠ¥å‘ŠæŸ¥çœ‹ç‡

3. **ç”¨æˆ·æ»¡æ„åº¦**
   - ç”¨æˆ·åé¦ˆè¯„åˆ†
   - åŠŸèƒ½æ»¡æ„åº¦
   - é—®é¢˜è§£å†³ç‡

### ç›‘æ§å·¥å…·
1. **ç³»ç»Ÿç›‘æ§**
   - Difyå·¥ä½œæµç›‘æ§
   - æ•°æ®åº“æ€§èƒ½ç›‘æ§
   - APIè°ƒç”¨ç›‘æ§

2. **ä¸šåŠ¡ç›‘æ§**
   - ç”¨æˆ·è¡Œä¸ºåˆ†æ
   - åŠŸèƒ½ä½¿ç”¨ç»Ÿè®¡
   - é”™è¯¯æ—¥å¿—åˆ†æ

3. **æ€§èƒ½åˆ†æ**
   - å“åº”æ—¶é—´åˆ†æ
   - å¹¶å‘æ€§èƒ½æµ‹è¯•
   - èµ„æºä½¿ç”¨åˆ†æ

## ğŸ’° æˆæœ¬åˆ†æ

### å¼€å‘æˆæœ¬
1. **äººåŠ›æˆæœ¬**
   - å¼€å‘äººå‘˜ï¼š2-3äºº Ã— 3ä¸ªæœˆ
   - æµ‹è¯•äººå‘˜ï¼š1äºº Ã— 2ä¸ªæœˆ
   - é¡¹ç›®ç®¡ç†ï¼š1äºº Ã— 3ä¸ªæœˆ

2. **æŠ€æœ¯æˆæœ¬**
   - Difyéƒ¨ç½²å’Œç»´æŠ¤
   - äº‘æœåŠ¡å™¨èµ„æº
   - æ•°æ®åº“å­˜å‚¨

### è¿è¥æˆæœ¬
1. **åŸºç¡€è®¾æ–½**
   - äº‘æœåŠ¡å™¨è´¹ç”¨
   - æ•°æ®åº“è´¹ç”¨
   - ç½‘ç»œå¸¦å®½è´¹ç”¨

2. **AIæœåŠ¡**
   - æ™ºè°±AI APIè°ƒç”¨è´¹ç”¨
   - Difyå¹³å°ä½¿ç”¨è´¹ç”¨
   - å…¶ä»–AIæœåŠ¡è´¹ç”¨

### é¢„æœŸæ”¶ç›Š
1. **æ•ˆç‡æå‡**
   - å¼€å‘æ•ˆç‡æå‡30%
   - ç»´æŠ¤æˆæœ¬é™ä½40%
   - éƒ¨ç½²æ—¶é—´ç¼©çŸ­50%

2. **ä¸šåŠ¡å¢é•¿**
   - ç”¨æˆ·ç•™å­˜ç‡æå‡15%
   - åŠŸèƒ½ä½¿ç”¨ç‡æå‡20%
   - ç”¨æˆ·æ»¡æ„åº¦æå‡25%

## ğŸ¯ ç»“è®ºå’Œå»ºè®®

### å¯è¡Œæ€§ç»“è®º
åŸºäºè¯¦ç»†çš„æŠ€æœ¯åˆ†æå’Œæ–¹æ¡ˆè®¾è®¡ï¼ŒHeartChat AIæµç¨‹é‡æ„Difyé›†æˆæ–¹æ¡ˆå…·æœ‰å¾ˆé«˜çš„å¯è¡Œæ€§ï¼š

1. **æŠ€æœ¯å¯è¡Œæ€§é«˜**ï¼šDifyå¹³å°æ”¯æŒå¤æ‚çš„å·¥ä½œæµæ„å»ºï¼Œèƒ½å¤Ÿæ»¡è¶³HeartChatçš„éœ€æ±‚
2. **æ•°æ®å…¼å®¹æ€§å¥½**ï¼šé€šè¿‡æ•°æ®è½¬æ¢å±‚å¯ä»¥ä¿æŒç°æœ‰æ•°æ®åº“ç»“æ„ä¸å˜
3. **æ€§èƒ½æå‡æ˜æ˜¾**ï¼šå‡å°‘äº‘å‡½æ•°é—´è°ƒç”¨ï¼Œæé«˜ç³»ç»Ÿå“åº”é€Ÿåº¦
4. **ç»´æŠ¤æ€§æ”¹å–„æ˜¾è‘—**ï¼šå¯è§†åŒ–å·¥ä½œæµç¼–è¾‘ï¼Œé™ä½ç»´æŠ¤å¤æ‚åº¦

### å®æ–½å»ºè®®
1. **ä¼˜å…ˆå®æ–½æ ¸å¿ƒåŠŸèƒ½**ï¼šå…ˆå®æ–½èŠå¤©å¯¹è¯å¤„ç†æµç¨‹ï¼Œå†é€æ­¥è¿ç§»å…¶ä»–åŠŸèƒ½
2. **ä¿æŒç°æœ‰ç³»ç»Ÿç¨³å®š**ï¼šåœ¨è¿ç§»è¿‡ç¨‹ä¸­ä¿æŒç°æœ‰ç³»ç»Ÿæ­£å¸¸è¿è¡Œ
3. **é‡è§†ç”¨æˆ·åé¦ˆ**ï¼šåŠæ—¶æ”¶é›†ç”¨æˆ·åé¦ˆï¼Œä¼˜åŒ–ç³»ç»ŸåŠŸèƒ½
4. **æŒç»­ç›‘æ§å’Œä¼˜åŒ–**ï¼šå»ºç«‹å®Œå–„çš„ç›‘æ§ä½“ç³»ï¼ŒæŒç»­ä¼˜åŒ–ç³»ç»Ÿæ€§èƒ½

### æœªæ¥å±•æœ›
1. **åŠŸèƒ½æ‰©å±•**ï¼šåŸºäºDifyå¹³å°ï¼Œå¯ä»¥æ›´å®¹æ˜“åœ°æ·»åŠ æ–°çš„AIåŠŸèƒ½
2. **æŠ€æœ¯å‡çº§**ï¼šæ”¯æŒæ›´å¤šAIæ¨¡å‹ï¼Œæå‡AIèƒ½åŠ›
3. **ä¸šåŠ¡æ‹“å±•**ï¼šä¸ºæœªæ¥ä¸šåŠ¡æ‹“å±•æä¾›æ›´å¥½çš„æŠ€æœ¯åŸºç¡€
4. **ç”¨æˆ·ä½“éªŒ**ï¼šæŒç»­æ”¹å–„ç”¨æˆ·ä½“éªŒï¼Œæå‡ç”¨æˆ·æ»¡æ„åº¦

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-01-09  
**ç»´æŠ¤å›¢é˜Ÿ**: HeartChat å¼€å‘å›¢é˜Ÿ