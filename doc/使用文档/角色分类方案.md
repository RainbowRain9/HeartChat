# 角色分类方案

## 概述

为了更好地组织和筛选角色，我们设计了一个角色分类系统，同时结合了"与用户的关系"和"角色分类"两个维度。这种设计既符合用户的思维习惯，又满足了系统对分类的需求。

## 分类体系

### 角色分类（Category）

我们定义了四个主要的角色分类：

1. **情感支持（emotion）**：提供情感陪伴和支持的角色
2. **心理咨询（psychology）**：提供心理咨询和辅导的角色
3. **生活伙伴（life）**：日常生活中的伙伴和家人角色
4. **职场导师（career）**：提供职业指导和建议的角色

### 与用户的关系（Relationship）

与此同时，我们定义了多种角色与用户的关系类型：

- 家人（父母、兄弟姐妹、子女等）
- 情侣（男/女朋友、配偶等）
- 朋友（好友、闺蜜、损友等）
- 老师（学校老师、导师等）
- 同事（上司、下属、同级同事等）
- 心理咨询师
- 职业导师
- 情感顾问
- 其他

## 关系与分类的映射

为了简化用户创建角色的流程，我们建立了关系与分类的默认映射关系：

| 关系类型 | 默认分类 |
|---------|---------|
| 家人 | 生活伙伴（life） |
| 情侣 | 情感支持（emotion） |
| 朋友 | 生活伙伴（life） |
| 老师 | 心理咨询（psychology） |
| 同事 | 职场导师（career） |
| 心理咨询师 | 心理咨询（psychology） |
| 职业导师 | 职场导师（career） |
| 情感顾问 | 情感支持（emotion） |
| 其他 | 生活伙伴（life） |

## 实现方案

### 用户界面设计

在角色编辑页面的基本信息步骤中：

1. 用户必须选择"与用户的关系"
2. "角色分类"作为可选项，默认根据关系自动设置
3. 用户可以修改系统推荐的分类

### 代码实现

```javascript
// 关系与分类的映射
const relationshipToCategoryMap = {
  '家人': 'life',
  '情侣': 'emotion',
  '朋友': 'life',
  '老师': 'psychology',
  '同事': 'career',
  '心理咨询师': 'psychology',
  '职业导师': 'career',
  '情感顾问': 'emotion',
  '其他': 'life'
};

// 当用户选择关系时自动设置推荐分类
handleRelationshipChange(e) {
  const index = e.detail.value;
  const relationship = this.data.relationshipOptions[index];
  
  this.setData({
    relationshipIndex: index,
    'form.relationship': relationship
  });
  
  // 根据关系推荐分类
  const recommendedCategory = relationshipToCategoryMap[relationship];
  if (recommendedCategory) {
    const categoryIndex = this.data.categoryOptions.findIndex(item => item.id === recommendedCategory);
    if (categoryIndex >= 0) {
      this.setData({
        categoryIndex: categoryIndex,
        'form.category': recommendedCategory
      });
    }
  }
}
```

### 保存逻辑

在保存角色时，如果用户未选择分类，系统会根据关系自动设置默认分类：

```javascript
// 保存前处理数据
handleSubmit() {
  // ...其他验证逻辑...
  
  // 如果没有设置category，根据relationship自动设置
  if (!this.data.form.category && this.data.form.relationship) {
    const defaultCategory = relationshipToCategoryMap[this.data.form.relationship] || 'life';
    this.setData({
      'form.category': defaultCategory
    });
  }
  
  // 继续保存逻辑...
}
```

## 用户体验考虑

1. **简化决策**：用户只需选择与角色的关系，系统会自动推荐合适的分类
2. **保留灵活性**：用户仍可以修改系统推荐的分类，满足特殊需求
3. **默认值保障**：即使用户未选择分类，系统也会根据关系设置默认值，确保数据完整性

## 数据结构更新

角色数据结构中添加了`category`字段：

```javascript
{
  _id: "角色ID",
  name: "角色名称",
  // ...其他字段...
  
  // 基本信息
  relationship: "与用户的关系", // 家人、情侣、老师、朋友等
  category: "角色分类", // emotion, psychology, life, career
  
  // ...其他字段...
}
```

## 角色选择页面适配

角色选择页面根据`category`字段进行筛选：

```javascript
getFilteredRoles() {
  const { roles, activeCategory, searchValue } = this.data;

  return roles.filter(role => {
    // 分类过滤
    if (activeCategory !== 'all' && role.category !== activeCategory) {
      return false;
    }

    // 搜索过滤
    if (searchValue && !role.name.includes(searchValue) && !role.description.includes(searchValue)) {
      return false;
    }

    return true;
  });
}
```

## 结论

通过结合"与用户的关系"和"角色分类"两个维度，我们实现了一个既符合用户思维习惯，又满足系统需求的角色分类方案。这种方案简化了用户创建角色的流程，同时保留了足够的灵活性，是一个较为平衡的解决方案。
