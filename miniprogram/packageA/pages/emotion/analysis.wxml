<view class="container">
  <!-- 输入区域 -->
  <view class="input-area">
    <textarea 
      class="input" 
      placeholder="输入文字进行情绪分析..." 
      bindinput="onInput"
      value="{{text}}"
      maxlength="500"
      auto-height
    />
    <view class="btn-area">
      <button 
        class="analyze-btn {{text ? 'active' : ''}}" 
        bindtap="analyzeText"
        loading="{{loading}}"
        disabled="{{!text || loading}}"
      >
        分析情绪
      </button>
    </view>
  </view>

  <!-- 分析结果 -->
  <block wx:if="{{emotion}}">
    <view class="result-card">
      <view class="card-title">情绪分析结果</view>
      <view class="emotion-type {{emotionType}}">
        <text class="label">主要情绪:</text>
        <text class="value">{{emotion}}</text>
      </view>
      <view class="analysis">
        <text class="label">详细分析:</text>
        <text class="content">{{analysis}}</text>
      </view>
      <view class="suggestions" wx:if="{{suggestions.length}}">
        <text class="label">建议:</text>
        <view class="suggestion-list">
          <text class="suggestion-item" wx:for="{{suggestions}}" wx:key="*this">
            {{index + 1}}. {{item}}
          </text>
        </view>
      </view>
    </view>
  </block>

  <!-- 历史记录 -->
  <view class="history-section">
    <view class="section-title">历史记录</view>
    <view class="history-list">
      <block wx:if="{{history.length}}">
        <view 
          class="history-item"
          wx:for="{{history}}" 
          wx:key="date"
          bindtap="viewDetail"
          data-index="{{index}}"
        >
          <view class="item-header">
            <text class="date">{{item.date}}</text>
            <text class="emotion {{item.emotionType}}">{{item.emotion}}</text>
          </view>
          <text class="content">{{item.content}}</text>
        </view>
      </block>
      <view class="empty" wx:else>
        <text>暂无历史记录</text>
      </view>
    </view>
  </view>

  <!-- 加载中 -->
  <view class="loading" wx:if="{{loading}}">
    <view class="loading-dots">
      <view class="dot"></view>
      <view class="dot"></view>
      <view class="dot"></view>
    </view>
  </view>
</view> 