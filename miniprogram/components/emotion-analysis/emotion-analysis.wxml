<!-- components/emotion-analysis/emotion-analysis.wxml -->
<view class="emotion-analysis {{show ? 'show' : ''}} {{darkMode ? 'dark' : ''}}">
  <view class="header">
    <view class="title">æƒ…æ„Ÿåˆ†æ</view>
    <view class="emotion-tag {{currentEmotion.type}}">
      {{currentEmotion.type || 'æœªçŸ¥'}}
    </view>
    <view class="close-btn" bindtap="closePanel">Ã—</view>
  </view>

  <!-- æƒ…æ„Ÿæ¦‚è§ˆ -->
  <view class="overview-section">
    <view class="overview-item">
      <view class="label">å½“å‰æƒ…ç»ª</view>
      <view class="value">{{currentEmotion.type || 'æœªçŸ¥'}}</view>
    </view>
    <view class="overview-item">
      <view class="label">æƒ…ç»ªå¼ºåº¦</view>
      <view class="value">{{intensityFormatted}}%</view>
    </view>
    <view class="overview-item">
      <view class="label">å˜åŒ–è¶‹åŠ¿</view>
      <view class="value">{{currentEmotion.trend || 'å¹³ç¨³'}}</view>
    </view>
  </view>

  <!-- æƒ…æ„Ÿè¶‹åŠ¿å›¾ - ç®€åŒ–ç‰ˆ -->
  <view class="chart-section">
    <view class="section-title">æƒ…æ„Ÿè¶‹åŠ¿</view>
    <view class="simple-chart-container">
      <view class="trend-info">
        <view class="trend-label">å½“å‰æƒ…ç»ªå¼ºåº¦</view>
        <view class="trend-value">{{intensityFormatted}}%</view>
      </view>
      <view class="progress-bar-container">
        <view class="progress-bar" style="width: {{intensityFormatted}}%"></view>
      </view>
    </view>
  </view>

  <!-- æƒ…æ„Ÿç»´åº¦ - ç®€åŒ–ç‰ˆ -->
  <view class="chart-section">
    <view class="section-title">æƒ…æ„Ÿåˆ†æ</view>
    <view class="dimensions-container">
      <view class="dimension-item" wx:for="{{emotionDimensions}}" wx:key="index">
        <view class="dimension-label">{{item}}</view>
        <view class="dimension-bar-container">
          <view class="dimension-bar" style="width: {{radarData[index]}}%"></view>
        </view>
        <view class="dimension-value">{{radarData[index]}}%</view>
      </view>
    </view>
  </view>

  <!-- æƒ…æ„Ÿå»ºè®® -->
  <view class="suggestion-section" wx:if="{{currentEmotion.suggestions && currentEmotion.suggestions.length > 0}}">
    <view class="section-title">æƒ…æ„Ÿå»ºè®®</view>
    <view class="suggestion-list">
      <view class="suggestion-item" wx:for="{{currentEmotion.suggestions}}" wx:key="index">
        <text class="suggestion-icon">ğŸ’¡</text>
        <text class="suggestion-text">{{item}}</text>
      </view>
    </view>
  </view>

  <!-- å…³é”®è¯äº‘ -->
  <view class="tags-section">
    <view class="section-title">å…³é”®è¯äº‘</view>
    <view class="tags-container">
      <block wx:if="{{keywords.length > 0}}">
        <view class="tag-item"
              wx:for="{{keywords}}"
              wx:key="index"
              style="font-size: {{12 + item.weight * 8}}px; opacity: {{0.6 + item.weight * 0.4}}">
          {{item.word}}
        </view>
      </block>
      <block wx:else>
        <view class="tag-item" wx:for="{{['ç§¯ææ€è€ƒ', 'æƒ…ç»ªç®¡ç†', 'å‹åŠ›ç¼“è§£', 'è‡ªæˆ‘å…³æ€€', 'æƒ…ç»ªç¨³å®š', 'å…±æƒ…èƒ½åŠ›', 'è‡ªä¿¡']}}" wx:key="index">
          {{item}}
        </view>
      </block>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-section">
    <button class="action-btn save-btn" bindtap="saveEmotion">
      <text class="btn-icon">ğŸ“</text>
      <text class="btn-text">è®°å½•å¿ƒæƒ…</text>
    </button>
    <button class="action-btn share-btn" bindtap="shareEmotion">
      <text class="btn-icon">ğŸ’Œ</text>
      <text class="btn-text">åˆ†äº«ç»™TA</text>
    </button>
  </view>
</view>
